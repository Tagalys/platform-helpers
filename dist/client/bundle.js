var TagalysPlatformHelpers;(()=>{"use strict";var e={607:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(521),a=n(92),o=n(89),s=n(192),u=n(125),c=n(392),l=n(463);t.default=r(r(r(r(r({globalContext:{set:function(e){return s.default.set(e)},getConfiguration:function(){return s.default.getConfiguration()},getShopifyConfiguration:function(){return s.default.getShopifyConfiguration()}},apiClient:function(){return new o.default}},i.default.export()),u.default.export()),c.default.export()),l.default.export()),a.default.export())},527:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMetafieldsToQuery=t.getIdFromGraphqlId=t.METAFIELD_TYPES=t.API_VERSION=t.getPriceDetails=t.getMax=t.getMin=t.getProductPriceAndCompareAtPrice=t.getVariantCompareAtPrices=t.getVariantPrices=t.applyCurrencyConversion=t.unique=void 0;var r=n(192);t.unique=function(e,t,n){return n.indexOf(e)===t},t.applyCurrencyConversion=function(e){if(null!==e){var t=r.default.configuration.getExchangeRate(),n=r.default.configuration.getFractionalDigits(),i=e*t;return Math.round(i*Math.pow(10,n))/Math.pow(10,n)}return null},t.getVariantPrices=function(e){return e.filter((function(e){return null!==e.node.price})).map((function(e){return parseFloat(e.node.price.amount)}))},t.getVariantCompareAtPrices=function(e){return e.filter((function(e){return null!==e.node.compareAtPrice})).map((function(e){return parseFloat(e.node.compareAtPrice.amount)}))},t.getProductPriceAndCompareAtPrice=function(e){var n=e.map((function(e){return parseFloat(e.node.price.amount)})),r=e.map((function(e){var t=parseFloat(e.node.price.amount);if(e.node.compareAtPrice){var n=parseFloat(e.node.compareAtPrice.amount);if(n>t)return n}return t})),i=n.length>0?Math.min.apply(Math,n):null,a=r.length>0?Math.min.apply(Math,r):null;return null!==a&&null!==i&&(a=Math.max.apply(Math,[i,a])),{price:null!==i?(0,t.applyCurrencyConversion)(i):null,compareAtPrice:null!==a?(0,t.applyCurrencyConversion)(a):null}},t.getMin=function(e){return e.length>0?Math.min.apply(Math,e):0},t.getMax=function(e){return e.length>0?Math.max.apply(Math,e):0},t.getPriceDetails=function(e){var n=e.variants.edges,r=(0,t.getProductPriceAndCompareAtPrice)(n),i=(0,t.getVariantCompareAtPrices)(n),a=(0,t.getVariantPrices)(n),o={};return n.forEach((function(e){var n=e.node.id.split("/").pop(),r=parseFloat(e.node.price.amount),i=e.node.compareAtPrice?parseFloat(e.node.compareAtPrice.amount):null;o[n]={price:(0,t.applyCurrencyConversion)(r),compare_at_price:(0,t.applyCurrencyConversion)(i)}})),{price:r.price,compare_at_price:r.compareAtPrice,price_varies:a.filter(t.unique).length>1,compare_at_price_varies:i.filter(t.unique).length>1,price_min:(0,t.applyCurrencyConversion)((0,t.getMin)(a)),price_max:(0,t.applyCurrencyConversion)((0,t.getMax)(a)),compare_at_price_min:(0,t.applyCurrencyConversion)((0,t.getMin)(i)),compare_at_price_max:(0,t.applyCurrencyConversion)((0,t.getMax)(i)),variantPricesMap:o}},t.API_VERSION="2024-04",t.METAFIELD_TYPES={LIST_PRODUCT_REFERENCE:"list.product_reference",COLLECTION_REFERENCE:"collection_reference",SINGLE_LINE_TEXT_FIELD:"single_line_text_field",LIST_SINGLE_LINE_TEXT_FIELD:"list.single_line_text_field",JSON:"json",RATING:"rating",NUMBER_INTEGER:"number_integer",BOOLEAN:"boolean"},t.getIdFromGraphqlId=function(e){var t=e.split("/").slice(-1)[0];return parseInt(t)},t.getMetafieldsToQuery=function(){return r.default.shopifyConfiguration.hasMetafields()?{product_metafields:r.default.shopifyConfiguration.getMetafields().products||[]}:{product_metafields:[]}}},192:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.set=function(e){this.configuration=e.configuration,this.shopifyConfiguration=e.shopifyConfiguration},e.prototype.getConfiguration=function(){return this.configuration},e.prototype.getShopifyConfiguration=function(){return this.shopifyConfiguration},e}();t.default=new n},509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.getImages=function(){return"\n      images(first: 250, sortKey: POSITION){\n        edges{\n          node{\n            altText\n            height\n            url\n            width\n            id\n          }\n        }\n      }\n    "},this.getBasicProductDetails=function(){return"\n      id\n      title\n      handle\n      onlineStoreUrl\n      productType\n      vendor\n      tags\n      publishedAt\n      availableForSale\n      options{\n        id\n        name\n        values\n      }\n      featuredImage{\n        altText\n        height\n        url\n        width\n        id\n      }\n      priceRange{\n        minVariantPrice{\n          amount\n        }\n        maxVariantPrice{\n          amount\n        }\n      }\n      compareAtPriceRange{\n        minVariantPrice{\n          amount\n        }\n        maxVariantPrice{\n          amount\n        }\n      }\n      featuredImage{\n        altText\n        height\n        url\n        width\n        id\n      }\n    "},this.getMedia=function(){return"\n      media(first: 250){\n        edges{\n          node{\n            alt\n            mediaContentType\n            ... on Video {\n              id\n              mediaContentType\n              previewImage{\n                id\n                altText\n                width\n                height\n                url\n              }\n              alt\n              sources {\n                format\n                height\n                mimeType\n                width\n                url\n              }\n            }\n            ... on MediaImage{\n              id\n              mediaContentType\n              previewImage{\n                id\n                altText\n                width\n                height\n                url\n              }\n              image{\n                id\n                altText\n                width\n                height\n                url\n              }\n            }\n            ... on ExternalVideo{\n              id\n              mediaContentType\n            }\n            ... on Model3d{\n              id\n              mediaContentType\n            }\n          }\n        }\n      }\n    "},this.getVariants=function(){return"\n      variants(first: 250){\n        edges{\n          node{\n            id\n            title\n            sku\n            selectedOptions{\n              name\n              value\n            }\n            image{\n              id\n            }\n            availableForSale\n            price {\n              amount\n            }\n            compareAtPrice{\n              amount\n            }\n          }\n        }\n      }\n    "},this.getReferenceMetafields=function(t){return t>=1?"":(t+=1,"\n      reference{\n        ... on Product{\n          ".concat(e.getBasicProductDetails(),"\n          ").concat(e.getVariants(),"\n          ").concat(e.getImages(),"\n          ").concat(e.getMedia(),"\n          ").concat(e.getAssociatedCollectionQuery(),"\n          ").concat(e.getProductMetafields(t),"\n        }\n        ... on Collection{\n          id\n          title\n          handle\n          products(first: 10){\n            edges{\n              node{\n                ").concat(e.getBasicProductDetails(),"\n                ").concat(e.getVariants(),"\n                ").concat(e.getImages(),"\n                ").concat(e.getMedia(),"\n                ").concat(e.getAssociatedCollectionQuery(),"\n                ").concat(e.getProductMetafields(t),"\n              }\n            }\n          }\n        }\n      }\n      references(first: 10){\n        edges{\n          node{\n            ... on Product{\n              ").concat(e.getBasicProductDetails(),"\n              ").concat(e.getVariants(),"\n              ").concat(e.getImages(),"\n              ").concat(e.getMedia(),"\n              ").concat(e.getAssociatedCollectionQuery(),"\n              ").concat(e.getProductMetafields(t),"\n            }\n          }\n        }\n      }\n    "))},this.getAssociatedCollectionQuery=function(){return"\n      collections(first:250){\n        edges{\n          node{\n            id\n            title\n            handle\n          }\n        }\n      }\n    "},this.getProductMetafields=function(t){return void 0===t&&(t=0),"\n      metafields(identifiers: $product_metafields){\n        id\n        key\n        namespace\n        type\n        value\n        description\n        ".concat(e.getReferenceMetafields(t),"\n      }\n    ")},this.getProductDetails=function(){return"\n      ".concat(e.getBasicProductDetails(),"\n      ").concat(e.getVariants(),"\n      ").concat(e.getImages(),"\n      ").concat(e.getMedia(),"\n      ").concat(e.getAssociatedCollectionQuery(),"\n      ").concat(e.getProductMetafields(),"\n    ")}}return e.getFilters=function(){return"\n      filters {\n        id\n        label\n        type\n        values {\n          id\n          label\n          count\n          input\n        }\n      }\n    "},e}();t.default=n},925:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(527),a="LIST",o="PRICE_RANGE",s="BOOLEAN",u=function(){function e(){}return e.prototype.hasOnlyDefaultVariant=function(e,t){return!(e.length>1||t.length>1||"Title"!==e[0]||"Default Title"!==t[0].option1||null!==t[0].option2||null!==t[0].option3)},e.prototype.formatProducts=function(e){var t=this;return e.edges.map((function(e){return t.formatProduct(e.node)}))},e.prototype.formatProduct=function(t,n){void 0===n&&(n=1);var r=this.formatVariants(t.variants),a=this.formatMedia(t.media),o=this.formatImages(t.images),s=(0,i.getPriceDetails)(t);return{id:(0,i.getIdFromGraphqlId)(t.id),title:t.title,published_at:t.publishedAt,available:t.availableForSale,tags:t.tags,variants:r,featured_image:this.getFeaturedImage(o),images:o,media:a,vendor:t.vendor,product_type:t.productType,metafields:this.formatMetafields(t.metafields,n),handle:t.handle,options_with_values:e.formatOptions(t.options),price:s.price,compare_at_price:s.compare_at_price,price_varies:s.price_varies,compare_at_price_varies:s.compare_at_price_varies,price_min:s.price_min,price_max:s.price_max,compare_at_price_min:s.compare_at_price_min,compare_at_price_max:s.compare_at_price_max,options:t.options.map((function(e){return e.name})),has_only_default_variant:this.hasOnlyDefaultVariant(t.options,r),collections:this.formatAssociatedCollectionDetails(t.collections)}},e.prototype.formatAssociatedCollectionDetails=function(e){return e.edges.map((function(e){return{id:(0,i.getIdFromGraphqlId)(e.node.id),handle:e.node.handle,title:e.node.title}}))},e.formatOptions=function(e){return e.map((function(e,t){return{name:e.name,position:t+1,values:e.values}}))},e.prototype.formatImages=function(e){return e.edges.map((function(e,t){var n=e.node;return{position:t+1,alt:n.altText,width:n.width,height:n.height,src:n.url}}))},e.prototype.formatMedia=function(e){var t=this,n=[];return e.edges.forEach((function(e,r){var i=r+1;"IMAGE"===e.node.mediaContentType&&n.push({position:i,media_type:"image",alt:e.node.image.altText,width:e.node.image.width,height:e.node.image.height,src:e.node.image.url,preview_image:t.formatImage(e.node.previewImage)}),"VIDEO"===e.node.mediaContentType&&n.push({position:i,media_type:"video",alt:e.node.alt,duration:e.node.duration,sources:t.formatVideoSources(e.node.sources),preview_image:t.formatImage(e.node.preview.image)})})),n},e.prototype.formatImage=function(e){return{alt:e.altText,width:e.width,height:e.height,src:e.url}},e.prototype.formatVideoSources=function(e){return e.map(this.formatVideoSource)},e.prototype.formatVideoSource=function(e){return{file_size:e.fileSize,format:e.format,mime_type:e.mime_type,height:e.height,width:e.width,url:e.url}},e.prototype.getFeaturedImage=function(e){return e.length>0?e.find((function(e){return 1===e.position})):null},e.prototype.formatVariants=function(e){var t=this;return e.edges.map((function(e,n){return r({id:(0,i.getIdFromGraphqlId)(e.node.id),title:e.node.title,sku:e.node.sku,price:e.node.price?(0,i.applyCurrencyConversion)(e.node.price.amount):null,compare_at_price:e.node.compareAtPrice?(0,i.applyCurrencyConversion)(e.node.compareAtPrice.amount):null,available:e.node.availableForSale,metafields:{}},t.formatSelectedVariantOptions(e.node))}))},e.prototype.formatSelectedVariantOptions=function(e){for(var t={},n=0;n<3;n++)t["option".concat(n+1)]=e.selectedOptions[n]?e.selectedOptions[n].value:null;return t},e.prototype.formatMetafields=function(e,t){var n=this,r={};return e.forEach((function(e){var i;e&&(r[i=e.namespace]||(r[i]={}),r[e.namespace][e.key]=n.formatMetafield(e,t))})),r},e.prototype.formatMetafield=function(e,t){var n=this,r=e.type,a=e.value;if(r===i.METAFIELD_TYPES.COLLECTION_REFERENCE){if(!e.reference)return{type:r,id:(0,i.getIdFromGraphqlId)(e.value)};a={id:(0,i.getIdFromGraphqlId)(e.reference.id),title:e.reference.title,handle:e.reference.handle,products:e.reference.products.edges.map((function(e){return n.formatProduct(e.node,t+1)}))}}if(r===i.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE){if(!e.references)return{type:r,ids:JSON.parse(a).map((function(e){return(0,i.getIdFromGraphqlId)(e)}))};a=e.references.edges.map((function(e){return n.formatProduct(e.node,t+1)}))}return[i.METAFIELD_TYPES.LIST_SINGLE_LINE_TEXT_FIELD,i.METAFIELD_TYPES.JSON,i.METAFIELD_TYPES.RATING,i.METAFIELD_TYPES.BOOLEAN].includes(r)&&(a=JSON.parse(a)),r===i.METAFIELD_TYPES.NUMBER_INTEGER&&(a=parseInt(a)),{type:r,value:a}},e.prototype.formatFilters=function(e,t,n){return e.map((function(e){var r=t[e.id],i=e.type===a||e.type===s,u=e.type===o;if(i)return{id:e.id,name:e.label,type:"checkbox",items:e.values.map((function(e){var t=!(!r||!r.includes(e.id));return{id:e.id,name:e.label,count:e.count,selected:t}}))};if(u){var c=JSON.parse(e.values[0].input),l=n.price_ranges,p={id:e.id,name:e.label,type:"range",display_format:"{{currency_label}}{{value}}",min:l?n.price_ranges.min:c.price.min,max:l?n.price_ranges.max:c.price.max};return r&&r.hasOwnProperty("selected_min")&&(p.selected_min=r.selected_min.toString(),p.selected_max=r.selected_max.toString()),p}}))},e.getFilterInputs=function(e){var t={};return e.forEach((function(e){var n=e.type===a||e.type===s,r=e.type===o;n&&e.values.forEach((function(e){t[e.id]={type:"checkbox",input:e.input,label:e.label}})),r&&(t[e.id]={type:"range",input:e.values[0].input,label:e.label})})),t},e.prototype.getImagesToVariantIdsMap=function(e){var t={};return e.edges.forEach((function(e){e.node.image&&(t[e.node.image.id]||(t[e.node.image.id]=[]),t[e.node.image.id].push(e.node.id))})),t},e}();t.default=u},358:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(527),o=n(192),s=n(509),u=n(925),c=function(){function e(e){this.productIds=e.map((function(e){return"gid://shopify/Product/".concat(e)}))}return e.prototype.translate=function(){return r(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return[4,fetch("https://".concat(o.default.shopifyConfiguration.getMyShopifyDomain(),"/api/").concat(a.API_VERSION,"/graphql.json"),{body:JSON.stringify({query:this.getQuery(),variables:this.getQueryVariables()}),headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":o.default.shopifyConfiguration.getStorefrontAPIAccessToken()},method:"POST"})];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),t=new u.default,[2,e.data.nodes.map((function(e){return t.formatProduct(e)}))]}}))}))},e.prototype.getQuery=function(){var e=(new s.default).getProductDetails(),t="country: ".concat(o.default.configuration.getCountryCode()),n="language: ".concat(o.default.configuration.getLanguageCode());return"query allProducts($product_metafields: [HasMetafieldsIdentifier!]!) @inContext(".concat(t,", ").concat(n,") {\n      nodes(ids: ").concat(JSON.stringify(this.productIds),"){\n        ... on Product{\n          ").concat(e,"\n        }\n      }\n    }")},e.prototype.getQueryVariables=function(){return(0,a.getMetafieldsToQuery)()},e}();t.default=c},92:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(527),s=n(192),u=n(358),c=function(){function e(){}return e.prototype.getProductDetailsForMarket=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,u,c,l,p,f=this;return a(this,(function(a){switch(a.label){case 0:return e.length?(t=e.map((function(e){return"gid://shopify/Product/".concat(e)})),n="\n      variants(first: 250){\n        edges{\n          node{\n            id\n            price {\n              amount\n            }\n            compareAtPrice{\n              amount\n            }\n          }\n        }\n      }\n    ",r=s.default.shopifyConfiguration.getMetafields(),i="",Object.keys(r).length>0&&(u=r.products.map((function(e){return'{namespace: "'.concat(e.namespace,'", key: "').concat(e.key,'"}')})),i="\n        metafields(identifiers: [".concat(u,"]){\n          id\n          key\n          namespace\n          type\n          value\n          reference{\n            ... on Collection{\n              products(first: 10){\n                edges{\n                  node{\n                    id\n                    ").concat(n,"\n                    metafields(identifiers: [").concat(u,"]){\n                      id\n                      key\n                      namespace\n                      type\n                      value\n                    }\n                  }\n                }\n              }\n            }\n          }\n          references(first: 10){\n            edges{\n              node{\n                ... on Product{\n                  id\n                  ").concat(n,"\n                  metafields(identifiers: [").concat(u,"]){\n                    id\n                    key\n                    namespace\n                    type\n                    value\n                  }\n                }\n              }\n            }\n          }\n        }\n      ")),[4,fetch("https://".concat(s.default.shopifyConfiguration.getMyShopifyDomain(),"/api/").concat(o.API_VERSION,"/graphql.json"),{body:" query allProducts @inContext(country: ".concat(s.default.configuration.getCountryCode(),") {\n        nodes(ids: ").concat(JSON.stringify(t),")\n        {\n          ... on Product{\n            id\n            ").concat(i,"\n            ").concat(n,"\n          }\n        }\n      }\n      "),headers:{"Content-Type":"application/graphql","X-Shopify-Storefront-Access-Token":s.default.shopifyConfiguration.getStorefrontAPIAccessToken()},method:"POST"})]):[2,{}];case 1:return[4,a.sent().json()];case 2:return c=a.sent(),l=c.data.nodes,p={},l.forEach((function(e){if(e){var t=(0,o.getIdFromGraphqlId)(e.id);p[t]=f.getMarketSpecificDetails(e)}})),[2,p]}}))}))},e.prototype.getMarketSpecificDetails=function(e){var t=this,n={};e.hasOwnProperty("metafields")&&e.metafields.forEach((function(e){var r;e&&(n[r=e.namespace]||(n[r]={}),n[e.namespace][e.key]={type:e.type,value:t.getMetafieldValue(e)})}));var i=(0,o.getPriceDetails)(e);return r(r({},i),{productId:(0,o.getIdFromGraphqlId)(e.id),metafields:n})},e.prototype.getMetafieldValue=function(e){var t=this,n=e.type,r=e.value;return n===o.METAFIELD_TYPES.COLLECTION_REFERENCE&&e.reference&&(r={products:e.reference.products.edges.map((function(e){return t.getMarketSpecificDetails(e.node)}))}),n===o.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE&&e.references&&(r=e.references.edges.map((function(e){return t.getMarketSpecificDetails(e.node)}))),r},e.prototype.updateProductDetailsForMarket=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i=this;return a(this,(function(a){switch(a.label){case 0:return e.hasOwnProperty("products")?(t=e.products.map((function(e){return e.id})),s.default.configuration.canUseStorefrontAPIForLanguageCode()?[4,new u.default(t).translate()]:[3,2]):[3,4];case 1:return n=a.sent(),e.products=n,[2,e];case 2:return[4,this.getProductDetailsForMarket(t)];case 3:r=a.sent(),e.products.forEach((function(e){r.hasOwnProperty(e.id)?i.mutateProductDetails(e,r[e.id]):i.resetProductPrice(e)})),a.label=4;case 4:return[2,e]}}))}))},e.prototype.mutateProductDetails=function(e,t){e.variants.forEach((function(e){e.price=t.variantPricesMap[e.id].price,e.compare_at_price=t.variantPricesMap[e.id].compare_at_price})),e.price_varies=t.price_varies,e.compare_at_price_varies=t.compare_at_price_varies,e.price=t.price,e.compare_at_price=t.compare_at_price,e.price_min=t.price_min,e.price_max=t.price_max,e.compare_at_price_min=t.compare_at_price_min,e.compare_at_price_max=t.compare_at_price_max,this.updateMetafieldPrices(e.metafields,t.metafields)},e.prototype.updateMetafieldPrices=function(e,t){for(var n in e)for(var r in e[n])if(t.hasOwnProperty(n)&&t[n].hasOwnProperty(r)){var i=t[n][r].value;e[n][r].type===o.METAFIELD_TYPES.COLLECTION_REFERENCE&&this.updateCollectionReferenceMetafield(e[n][r],i),e[n][r].type===o.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE&&this.updateProductListReferenceMetafield(e[n][r],i)}else delete e[n][r],0===Object.keys(e[n]).length&&delete e[n]},e.prototype.idPresentInGivenList=function(e,t){return e.find((function(e){return e===t}))===t},e.prototype.updateCollectionReferenceMetafield=function(e,t){var n=this;if(e.value&&e.value.hasOwnProperty("products")&&Array.isArray(t.products)){var r=t.products.map((function(e){return parseInt(e.productId)}));e.value.products=e.value.products.filter((function(e){return n.idPresentInGivenList(r,parseInt(e.id))})),e.value.products.forEach((function(e){t.hasOwnProperty("products")&&t.products.forEach((function(t){e.id===t.productId&&n.mutateProductDetails(e,t)}))}))}},e.prototype.updateProductListReferenceMetafield=function(e,t){var n=this;if(Array.isArray(t)){var r=t.map((function(e){return parseInt(e.productId)}));e.value=e.value.filter((function(e){return n.idPresentInGivenList(r,parseInt(e.id))})),e.value.forEach((function(e){t.forEach((function(t){e.id===t.productId&&n.mutateProductDetails(e,t)}))}))}},e.prototype.resetProductPrices=function(e){var t=this;return e.products?e.products.forEach((function(e){return t.resetProductPrice(e)})):e},e.prototype.resetProductPrice=function(e){e.price_varies=null,e.compare_at_price_varies=null,e.price=null,e.compare_at_price=null,e.price_min=null,e.price_max=null,e.compare_at_price_min=null,e.compare_at_price_max=null,e.variants.map((function(e){e.price=null,e.compare_at_price=null})),this.resetMetafieldPrices(e.metafields)},e.prototype.resetMetafieldPrices=function(e){var t=this;for(var n in e)for(var r in e[n]){var i=e[n][r];i.type===o.METAFIELD_TYPES.COLLECTION_REFERENCE&&i.value&&i.value.hasOwnProperty("products")&&e[n][r].value.products.map((function(e){t.resetProductPrice(e)})),i.type===o.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE&&i.value&&i.value.map((function(e){"object"==typeof e&&t.resetProductPrice(e)}))}},e.prototype.helpersToExpose=function(){var e=this;return{updateProductDetailsForMarket:function(t){return e.updateProductDetailsForMarket(t)},resetProductPrices:function(t){return e.resetProductPrices(t)}}},e.export=function(){var e=this;return{MultiMarket:{new:function(){return(new e).helpersToExpose()}}}},e}();t.default=c},89:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(527),o=n(192),s=function(){function e(){}return e.prototype.call=function(e,t,n,a){return void 0===a&&(a={}),r(this,void 0,void 0,(function(){var r,a;return i(this,(function(i){switch(i.label){case 0:return[4,fetch(this.url(t),{body:n.params,headers:{"Content-Type":"application/json",Accept:"application/json","X-Shopify-Storefront-Access-Token":o.default.shopifyConfiguration.getStorefrontAPIAccessToken()},method:e})];case 1:return 200!==(r=i.sent()).status?[3,3]:[4,r.json()];case 2:return a=i.sent(),n.hasOwnProperty("onSuccess")?[2,n.onSuccess(a.data)]:[2,a.data];case 3:return void 0!==n.onFailure?[2,n.onFailure(r)]:[2,r]}}))}))},e.prototype.url=function(e){return"https://".concat(o.default.shopifyConfiguration.getMyShopifyDomain(),"/api/").concat(a.API_VERSION,"/").concat(e)},e}();t.default=s},521:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var a=n(527),o=n(192),s=function(e,t,n){return n.indexOf(e)===t},u=function(){function e(){var e=this;this.formatDetail=function(t){var n={};for(var i in t)switch(i){case"__id":n.id=parseInt(t.__id);break;case"name":n.title=t.name;break;case"available":n.available=t.available;break;case"shopify_tags":n.tags=e.formatTags(t.shopify_tags);break;case"variants":n=r(r(r(r({},n),{variants:e.formatVariants(t.variants)}),e.getOptionRelatedFields(t)),e.getPriceRelatedFields(t));break;case"_vendor":n.vendor=e.formatVendor(t._vendor);break;case"images":n.images=e.formatImages(t.images);break;case"metafields":n.metafields=e.formatMetafields(t);break;case"link":n.handle=t.link.split("/products/")[1];break;case"introduced_at":n.published_at=t.introduced_at;break;case"media":var a=e.formatImages(t.images);n.featured_image=e.getFeaturedImage(a),n.media=t.media;case"_product_type":n.product_type=e.formatProductType(t._product_type);break;case"published_collections_on_online_store":n.collections=t.published_collections_on_online_store}return n}}return e.prototype.formatImages=function(e){return e.map((function(e){return{position:e.position,alt:e.alt,width:e.width,height:e.height,src:e.src}}))},e.prototype.getFeaturedImage=function(e){return e.length>0&&e.find((function(e){return 1===e.position}))||null},e.prototype.formatTags=function(e){return Array.isArray(e)?e:e.split(", ").sort()},e.prototype.formatVendor=function(e){return Array.isArray(e)?e[0]:e},e.prototype.formatProductType=function(e){return Array.isArray(e)?e[0]:e},e.prototype.formatMetafields=function(e){var t=this;for(var n in e.metafields)for(var r in e.metafields[n])if(o.default.shopifyConfiguration.isMetafieldConfigured(n,r,"products")){if(e.hasOwnProperty("_references")){if(e._references.metafields.hasOwnProperty(n)&&e._references.metafields[n].hasOwnProperty(r)){var i=e._references.metafields[n][r];e.metafields[n][r].type===a.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE&&(e.metafields[n][r].value=i.value.map((function(e){return t.formatDetail(e)}))),e.metafields[n][r].type===a.METAFIELD_TYPES.COLLECTION_REFERENCE&&(e.metafields[n][r].value={id:parseInt(i.value.id),title:i.value.name,handle:i.value.slug,products:i.value.product_details.map((function(e){return t.formatDetail(e)}))})}}else e.metafields[n][r].type===a.METAFIELD_TYPES.COLLECTION_REFERENCE&&(e.metafields[n][r].id=parseInt(e.metafields[n][r].value[0]),delete e.metafields[n][r].value),e.metafields[n][r].type===a.METAFIELD_TYPES.LIST_PRODUCT_REFERENCE&&(e.metafields[n][r].ids=e.metafields[n][r].value.map((function(e){return parseInt(e)})),delete e.metafields[n][r].value);e.metafields[n][r].type===a.METAFIELD_TYPES.SINGLE_LINE_TEXT_FIELD&&(Array.isArray(e.metafields[n][r].value)?e.metafields[n][r].value=e.metafields[n][r].value[0]:e.metafields[n][r].value=e.metafields[n][r].value)}else delete e.metafields[n][r],0===Object.keys(e.metafields[n]).length&&delete e.metafields[n];return e.metafields},e.prototype.getPriceRelatedFields=function(e){var t=e.variants.filter((function(e){return null!==e.compare_at_price})).map((function(e){return e.compare_at_price})),n=e.variants.filter((function(e){return null!==e.price})).map((function(e){return e.price})),r=e.sale_price,i=t.length>0?Math.min.apply(Math,t):null,o=Math.min.apply(Math,n),u=Math.max.apply(Math,n),c=Math.min.apply(Math,t),l=Math.max.apply(Math,t);return{price_varies:n.filter(s).length>1,compare_at_price_varies:t.filter(s).length>1,price:r?(0,a.applyCurrencyConversion)(r):null,compare_at_price:i?(0,a.applyCurrencyConversion)(i):null,price_min:(0,a.applyCurrencyConversion)(o),price_max:(0,a.applyCurrencyConversion)(u),compare_at_price_min:(0,a.applyCurrencyConversion)(c),compare_at_price_max:(0,a.applyCurrencyConversion)(l)}},e.prototype.getOptionRelatedFields=function(e){var t={};if(e.hasOwnProperty("variants")&&e.hasOwnProperty("options")){var n=e.options.map((function(e){return e.name}));t.options=n,t.options_with_values=e.options.map((function(e){return{name:e.name,position:e.position,values:e.values}})),t.has_only_default_variant=this.hasOnlyDefaultVariant(n,e.variants)}return t},e.prototype.formatVariants=function(e){return e&&e.length?e.map((function(e){return e.price&&(e.price=(0,a.applyCurrencyConversion)(e.price)),e.compare_at_price&&(e.compare_at_price=(0,a.applyCurrencyConversion)(e.compare_at_price)),e.position,i(e,["position"])})):[]},e.prototype.hasOnlyDefaultVariant=function(e,t){return!(e.length>1||t.length>1||"Title"!==e[0]||"Default Title"!==t[0].option1||null!==t[0].option2||null!==t[0].option3)},e.prototype.helpersToExpose=function(){var e=this;return{formatDetail:function(t){return e.formatDetail(t)}}},e.export=function(){var e=this;return{TagalysToCommonResponseFormatter:{new:function(){return(new e).helpersToExpose()}}}},e}();t.default=u},824:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(509),i=n(89),a=n(925),o=n(192),s=function(){function e(e,t){this.requestState=e,this.responseState=t,this.queries=new r.default,this.graphqlResponseFormatter=new a.default}return e.prototype.apiClient=function(){return new i.default},e.prototype.getPaginationVariables=function(){var e={};return this.requestState.endCursor&&(e.after=this.requestState.endCursor,e.first=this.requestState.perPage),this.requestState.startCursor&&(e.before=this.requestState.startCursor,e.last=this.requestState.perPage),this.requestState.startCursor||this.requestState.endCursor||(e.first=this.requestState.perPage),e},e.prototype.getFilterVariables=function(){var e=this,t={};if(Object.keys(this.requestState.filters).length){for(var n=[],r=0,i=Object.entries(this.requestState.filters);r<i.length;r++){var a=i[r],o=(a[0],a[1]),s=o;o.hasOwnProperty("selected_min")?n.push({price:{min:parseFloat(o.selected_min),max:parseFloat(o.selected_max)}}):s.forEach((function(t){if(e.responseState.filter_inputs&&e.responseState.filter_inputs[t]){var r=e.responseState.filter_inputs[t];n.push(JSON.parse(r.input))}}))}t.filters=n}return t},e.prototype.getMetafieldVariables=function(){return o.default.shopifyConfiguration.hasMetafields()?{product_metafields:o.default.shopifyConfiguration.getMetafields().products||[]}:{product_metafields:[]}},e.prototype.getSortOptions=function(e,t){var n=this,r=e.params.sort_options||t;return r.forEach((function(e){e.id===n.requestState.sort?e.selected=!0:e.selected=!1})),null===this.requestState.sort&&r.length>0&&(r[0].selected=!0),r},e.prototype.getFilterData=function(e){var t=a.default.getFilterInputs(e),n=e.find((function(e){return"PRICE_RANGE"===e.type})),r={};n&&(r=JSON.parse(n.values[0].input).price);for(var i={},o=function(t,n){var r=e.find((function(e){return e.id===t}));if(r)if(Array.isArray(n)){var a=[];n.forEach((function(e){"LIST"!==r.type&&"BOOLEAN"!==r.type||r.values.forEach((function(t){e===t.label&&a.push(t.id)}))})),i[t]=a}else i[t]=n},s=0,u=Object.entries(this.requestState.filters);s<u.length;s++){var c=u[s];o(c[0],c[1])}return{filtersForRequestParams:i,filter_inputs:t,price_ranges:r}},e}();t.default=s},125:function(e,t,n){var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(509),c=n(925),l=n(192),p=n(824),f=[{id:"manual",label:"Featured"},{id:"best-selling",label:"Best selling"},{id:"title-asc",label:"Alphabetically, A-Z"},{id:"title-desc",label:"Alphabetically, Z-A"},{id:"price-asc",label:"Price, low to high"},{id:"price-desc",label:"Price, high to low"},{id:"created-asc",label:"Date, old to new"},{id:"created-desc",label:"Date, new to old"}],d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getQuery=function(){return"\n      query Collection(\n        $id: ID,\n        $first: Int,\n        $last: Int,\n        $before: String,\n        $after: String,\n        $sortKey: ProductCollectionSortKeys,\n        $reverse: Boolean,\n        $filters: [ProductFilter!],\n        $product_metafields: [HasMetafieldsIdentifier!]!,\n      ) @inContext(country: ".concat(l.default.configuration.getCountryCode(),") {\n        collection(id: $id){\n          title\n          handle\n          products(first: $first, last: $last, after: $after, before: $before, sortKey: $sortKey, reverse: $reverse, filters: $filters) {\n            filters {\n              id\n              label\n              type\n              values {\n                id\n                label\n                count\n                input\n              }\n            }\n            edges{\n              node{\n                ").concat(this.queries.getProductDetails(),"\n              }\n            }\n            pageInfo{\n              hasNextPage\n              hasPreviousPage\n              endCursor\n              startCursor\n            }\n          }\n        }\n      }\n    ")},t.prototype.getQueryVariables=function(){return a(a(a(a({id:"gid://shopify/Collection/".concat(this.requestState.product_listing_page_id)},this.getSortVariables()),this.getPaginationVariables()),this.getFilterVariables()),this.getMetafieldVariables())},t.prototype.getSortVariables=function(){return{manual:{sortKey:"MANUAL",reverse:!1},"best-selling":{sortKey:"BEST_SELLING",reverse:!1},"created-desc":{sortKey:"CREATED",reverse:!0},"created-asc":{sortKey:"CREATED",reverse:!1},"price-desc":{sortKey:"PRICE",reverse:!0},"price-asc":{sortKey:"PRICE",reverse:!1},"title-asc":{sortKey:"TITLE",reverse:!1},"title-desc":{sortKey:"TITLE",reverse:!0},id:{sortKey:"ID",reverse:!1},"collection-default":{sortKey:"COLLECTION_DEFAULT",reverse:!1}}[this.requestState.sort]},t.getFilterInputsQuery=function(){return"\n    query Collection(\n      $id: ID,\n    ) {\n      collection(id: $id){\n        products(first: 1) {\n          ".concat(u.default.getFilters(),"\n        }\n      }\n    }\n    ")},t.prototype.getDataForInitialRequest=function(e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return n=t.getFilterInputsQuery(),[4,this.apiClient().call("POST","graphql.json",{params:JSON.stringify({query:n,variables:{id:"gid://shopify/Collection/".concat(e.params.product_listing_page_id)}})})];case 1:return r=i.sent(),[2,this.getFilterData(r.collection.products.filters)]}}))}))},t.prototype.formatResponse=function(e,t){return{name:t.collection.title,products:this.graphqlResponseFormatter.formatProducts(t.collection.products),filters:this.graphqlResponseFormatter.formatFilters(t.collection.products.filters,this.requestState.filters,this.responseState.price_ranges),sort_options:this.getSortOptions(e,f),page_info:t.collection.products.pageInfo,filter_inputs:c.default.getFilterInputs(t.collection.products.filters)}},t.prototype.helpersToExpose=function(){var e=this;return{getQuery:function(){return e.getQuery()},getQueryVariables:function(){return e.getQueryVariables()},formatResponse:function(t,n){return e.formatResponse(t,n)},getFilterInputs:function(e){return c.default.getFilterInputs(e)},getDataForInitialRequest:function(t){return e.getDataForInitialRequest(t)}}},t.export=function(){var e=this;return{ProductListingPage:{new:function(t,n){return new e(t,n).helpersToExpose()}}}},t}(p.default);t.default=d},392:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(509),a=n(89),o=n(925),s=n(192),u=function(){function e(e,t){var n=this;this.getSearchSuggestionsQuery=function(e){var t="";return e.includes("queries")&&(t+="\n        queries {\n          text\n        }\n      "),e.includes("collections")&&(t+="\n        collections {\n          id\n          title\n          onlineStoreUrl\n        }\n      "),e.includes("products")&&(t+="\n        products {\n          ".concat(n.queries.getProductDetails(),"\n        }\n      ")),e.includes("pages")&&(t+="\n        pages {\n          id\n          title\n          onlineStoreUrl\n        }\n      "),e.includes("articles")&&(t+="\n        articles {\n          id\n          title\n          onlineStoreUrl\n        }\n      "),t},this.requestState=e,this.responseState=t,this.queries=new i.default,this.graphqlResponseFormatter=new o.default}return e.prototype.getQuery=function(){var e,t,n=this.validateRequest(),r=n.valid,i=n.message;if(!r)throw new Error(i);var a=this.getResourcesToRequest(),o=this.getSearchSuggestionsQuery(a),u=a.includes("products"),c=(null===(t=null===(e=this.requestState.params)||void 0===e?void 0:e.searchableFields)||void 0===t?void 0:t.length)>0;return"\n      query SearchSuggestions(\n        $query: String!,\n        $types: [PredictiveSearchType!],\n        ".concat(u?"$product_metafields: [HasMetafieldsIdentifier!]!":"",",\n        ").concat(c?"$searchableFields: '[SearchableField!]":"","\n      ) @inContext(\n          country: ").concat(s.default.configuration.getCountryCode(),",\n          language: ").concat(s.default.configuration.getLanguageCode(),"\n        ){\n        predictiveSearch(\n          query: $query,\n          limitScope: EACH,\n          limit: 10,\n          unavailableProducts: ").concat(this.requestState.params.unavailableProducts,",\n          ").concat(c?"searchableFields: $searchableFields":"",",\n          types: $types\n        ){\n          ").concat(o,"\n        }\n      }\n    ")},e.prototype.getQueryVariables=function(){var e,t,n=this,i=r({query:"".concat(this.requestState.params.query),types:this.getResourcesToRequest().map((function(e){return n.getSearchableResourceType(e)}))},this.getMetafieldVariables());return(null===(t=null===(e=this.requestState.params)||void 0===e?void 0:e.searchableFields)||void 0===t?void 0:t.length)>0&&(i.searchableFields=this.requestState.params.searchableFields),i},e.prototype.getMetafieldVariables=function(){return s.default.shopifyConfiguration.hasMetafields()?{product_metafields:s.default.shopifyConfiguration.getMetafields().products||[]}:{product_metafields:[]}},e.prototype.getSearchableResourceType=function(e){switch(e){case"collections":return"COLLECTION";case"products":return"PRODUCT";case"pages":return"PAGE";case"articles":return"ARTICLE";case"queries":return"QUERY"}},e.prototype.validateRequest=function(){var e=["queries","collections","products","pages","articles"],t=this.getResourcesToRequest().every((function(t){return e.includes(t)}));return{valid:t,message:t?"":"Invalid request type requested, allowed types are ".concat(e.join(", "))}},e.prototype.getResourcesToRequest=function(){return Object.keys(this.requestState.params.request)},e.prototype.formatResponse=function(e,t){var n=this,r={queries:[],products:[]},i=t.predictiveSearch;return this.getResourcesToRequest().forEach((function(e){var t=n.requestState.params.request[e].limit;if(i[e].length>0)switch(e){case"queries":var a={section_id:"queries",section_title:"Queries",items:i.queries.slice(0,t).map((function(e){return{displayString:e.text,queryString:"".concat(n.requestState.queryStringConfiguration.queryParameter,"=").concat(e.text)}}))};r.queries.push(a);break;case"collections":a={section_id:"collections",section_title:"Collections",items:i.collections.slice(0,t).map((function(e){return{displayString:e.title,link:e.onlineStoreURL}}))},r.queries.push(a);break;case"pages":a={section_id:"pages",section_title:"Pages",items:i.pages.slice(0,t).map((function(e){return{displayString:e.title,link:e.onlineStoreUrl}}))},r.queries.push(a);break;case"articles":a={section_id:"articles",section_title:"Articles",items:i.articles.slice(0,t).map((function(e){return{displayString:e.title,link:e.onlineStoreUrl}}))},r.queries.push(a);break;case"products":r.products=i.products.slice(0,t).map((function(e){return n.graphqlResponseFormatter.formatProduct(e)}))}})),r},e.prototype.apiClient=function(){return new a.default},e.prototype.helpersToExpose=function(){var e=this;return{getQuery:function(){return e.getQuery()},getQueryVariables:function(){return e.getQueryVariables()},formatResponse:function(t,n){return e.formatResponse(t,n)}}},e.export=function(){var e=this;return{SearchSuggestions:{new:function(t,n){return new e(t,n).helpersToExpose()}}}},e}();t.default=u},463:function(e,t,n){var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(925),c=n(192),l=n(824),p=[{id:"relevance",label:"Relevance"},{id:"price-asc",label:"Price, low to high"},{id:"price-desc",label:"Price, high to low"}],f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getQuery=function(){return"\n      query Search(\n        $query: String!,\n        $first: Int,\n        $last: Int,\n        $before: String,\n        $after: String,\n        $sortKey: SearchSortKeys,\n        $reverse: Boolean,\n        $filters:  [ProductFilter!],\n        $product_metafields: [HasMetafieldsIdentifier!]!,\n        $prefix: SearchPrefixQueryType,\n        $unavailableProducts: SearchUnavailableProductsType,\n        $types: [SearchType!]\n      ) @inContext(\n          country: ".concat(c.default.configuration.getCountryCode(),",\n          language: ").concat(c.default.configuration.getLanguageCode(),"\n        ) {\n        search(\n          query: $query,\n          first: $first,\n          last: $last,\n          after: $after,\n          before: $before,\n          reverse: $reverse,\n          sortKey: $sortKey,\n          productFilters: $filters,\n          prefix: $prefix,\n          unavailableProducts: $unavailableProducts,\n          types: $types,\n        ){\n          totalCount\n          edges{\n            node{\n              ... on Product{\n                ").concat(this.queries.getProductDetails(),"\n              }\n            }\n          }\n          filters: productFilters {\n            id\n            label\n            type\n            values {\n              id\n              label\n              count\n              input\n            }\n          }\n          pageInfo{\n            hasNextPage\n            hasPreviousPage\n            endCursor\n            startCursor\n          }\n        }\n      }\n    ")},t.prototype.getQueryVariables=function(){return a(a(a(a({query:"".concat(this.requestState.query),unavailableProducts:this.requestState.unavailableProducts,prefix:this.requestState.prefix,types:this.requestState.types},this.getSortVariables()),this.getPaginationVariables()),this.getFilterVariables()),this.getMetafieldVariables())},t.prototype.getSortVariables=function(){return{relevance:{sortKey:"RELEVANCE",reverse:!1},"price-desc":{sortKey:"PRICE",reverse:!0},"price-asc":{sortKey:"PRICE",reverse:!1}}[this.requestState.sort]},t.getFilterInputsQuery=function(){return"\n    query Search(\n      $query: String!,\n    ) {\n      search(query: $query, first: 1){\n        filters: productFilters {\n          id\n          label\n          type\n          values {\n            id\n            label\n            count\n            input\n          }\n        }\n      }\n    }\n    "},t.prototype.getDataForInitialRequest=function(e){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return e=t.getFilterInputsQuery(),[4,this.apiClient().call("POST","graphql.json",{params:JSON.stringify({query:e,variables:{query:"".concat(this.requestState.query)}})})];case 1:return n=r.sent(),[2,this.getFilterData(n.search.filters)]}}))}))},t.prototype.formatResponse=function(e,t){var n=this;return{query:this.requestState.query,products:t.search.edges.map((function(e){return n.graphqlResponseFormatter.formatProduct(e.node)})),filters:this.graphqlResponseFormatter.formatFilters(t.search.filters,this.requestState.filters,this.responseState.price_ranges),sort_options:this.getSortOptions(e,p),page_info:t.search.pageInfo,filter_inputs:u.default.getFilterInputs(t.search.filters),total:t.search.totalCount}},t.prototype.helpersToExpose=function(){var e=this;return{getQuery:function(){return e.getQuery()},getQueryVariables:function(){return e.getQueryVariables()},formatResponse:function(t,n){return e.formatResponse(t,n)},getFilterInputs:function(e){return u.default.getFilterInputs(e)},getDataForInitialRequest:function(t){return e.getDataForInitialRequest(t)}}},t.export=function(){var e=this;return{Search:{new:function(t,n){return new e(t,n).helpersToExpose()}}}},t}(l.default);t.default=f}},t={},n=function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}(607);TagalysPlatformHelpers=n})();